{
  "hash": "8aaab78bc1a32d4e3ae89b2b525ee046",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 'Exemple Python : Analyse et Machine Learning'\nsubtitle: Classification de donn√©es avec Scikit-learn\nauthor: Parcours IA\ndate: last-modified\nformat:\n  html:\n    code-fold: show\n    code-tools: true\n    toc: true\nexecute:\n  enabled: true\n  cache: true\n---\n\n## üêç Introduction\n\nCe notebook d√©montre une analyse compl√®te de donn√©es et un mod√®le de machine learning en Python, incluant :\n\n- Chargement et exploration de donn√©es\n- Visualisation\n- Pr√©paration des donn√©es\n- Entra√Ænement de mod√®les\n- √âvaluation des performances\n\n## üìö Importation des Biblioth√®ques\n\n::: {#235805e1 .cell execution_count=1}\n``` {.python .cell-code}\n# Manipulation de donn√©es\nimport numpy as np\nimport pandas as pd\n\n# Visualisation\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Machine Learning\nfrom sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import (\n    accuracy_score, \n    classification_report, \n    confusion_matrix,\n    roc_auc_score,\n    roc_curve\n)\n\n# Configuration de l'affichage\nplt.style.use('seaborn-v0_8-darkgrid')\nsns.set_palette(\"husl\")\npd.set_option('display.max_columns', None)\n\nprint(\"‚úÖ Biblioth√®ques import√©es avec succ√®s\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n‚úÖ Biblioth√®ques import√©es avec succ√®s\n```\n:::\n:::\n\n\n## üìä Chargement des Donn√©es\n\nNous utilisons le c√©l√®bre dataset Iris pour cette d√©monstration.\n\n::: {#2c6f7b4f .cell execution_count=2}\n``` {.python .cell-code}\n# Charger le dataset Iris\niris = load_iris()\ndf = pd.DataFrame(\n    data=iris.data, \n    columns=iris.feature_names\n)\ndf['species'] = iris.target\ndf['species_name'] = df['species'].map({\n    0: 'setosa', \n    1: 'versicolor', \n    2: 'virginica'\n})\n\nprint(f\"üìà Dataset charg√© : {df.shape[0]} lignes, {df.shape[1]} colonnes\")\nprint(\"\\nPremi√®res lignes :\")\ndf.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nüìà Dataset charg√© : 150 lignes, 6 colonnes\n\nPremi√®res lignes :\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sepal length (cm)</th>\n      <th>sepal width (cm)</th>\n      <th>petal length (cm)</th>\n      <th>petal width (cm)</th>\n      <th>species</th>\n      <th>species_name</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>5.1</td>\n      <td>3.5</td>\n      <td>1.4</td>\n      <td>0.2</td>\n      <td>0</td>\n      <td>setosa</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>4.9</td>\n      <td>3.0</td>\n      <td>1.4</td>\n      <td>0.2</td>\n      <td>0</td>\n      <td>setosa</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>4.7</td>\n      <td>3.2</td>\n      <td>1.3</td>\n      <td>0.2</td>\n      <td>0</td>\n      <td>setosa</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4.6</td>\n      <td>3.1</td>\n      <td>1.5</td>\n      <td>0.2</td>\n      <td>0</td>\n      <td>setosa</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5.0</td>\n      <td>3.6</td>\n      <td>1.4</td>\n      <td>0.2</td>\n      <td>0</td>\n      <td>setosa</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## üîç Exploration des Donn√©es\n\n### Statistiques Descriptives\n\n::: {#0b5e52ca .cell execution_count=3}\n``` {.python .cell-code}\nprint(\"üìä Statistiques descriptives :\")\ndf.describe()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nüìä Statistiques descriptives :\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sepal length (cm)</th>\n      <th>sepal width (cm)</th>\n      <th>petal length (cm)</th>\n      <th>petal width (cm)</th>\n      <th>species</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>150.000000</td>\n      <td>150.000000</td>\n      <td>150.000000</td>\n      <td>150.000000</td>\n      <td>150.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>5.843333</td>\n      <td>3.057333</td>\n      <td>3.758000</td>\n      <td>1.199333</td>\n      <td>1.000000</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>0.828066</td>\n      <td>0.435866</td>\n      <td>1.765298</td>\n      <td>0.762238</td>\n      <td>0.819232</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>4.300000</td>\n      <td>2.000000</td>\n      <td>1.000000</td>\n      <td>0.100000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>5.100000</td>\n      <td>2.800000</td>\n      <td>1.600000</td>\n      <td>0.300000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>5.800000</td>\n      <td>3.000000</td>\n      <td>4.350000</td>\n      <td>1.300000</td>\n      <td>1.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>6.400000</td>\n      <td>3.300000</td>\n      <td>5.100000</td>\n      <td>1.800000</td>\n      <td>2.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>7.900000</td>\n      <td>4.400000</td>\n      <td>6.900000</td>\n      <td>2.500000</td>\n      <td>2.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Distribution des Classes\n\n::: {#e5ea947c .cell execution_count=4}\n``` {.python .cell-code}\nprint(\"\\nüå∏ Distribution des esp√®ces :\")\nclass_dist = df['species_name'].value_counts()\nprint(class_dist)\n\n# Visualisation\nplt.figure(figsize=(10, 5))\nclass_dist.plot(kind='bar', color=['#FF6B6B', '#4ECDC4', '#45B7D1'])\nplt.title('Distribution des Esp√®ces d\\'Iris', fontsize=14, fontweight='bold')\nplt.xlabel('Esp√®ce')\nplt.ylabel('Nombre d\\'√©chantillons')\nplt.xticks(rotation=45)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nüå∏ Distribution des esp√®ces :\nspecies_name\nsetosa        50\nversicolor    50\nvirginica     50\nName: count, dtype: int64\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](python-example_files/figure-html/cell-5-output-2.png){}\n:::\n:::\n\n\n## üìà Visualisation des Donn√©es\n\n### Pairplot des Features\n\n::: {#b73c9e6d .cell execution_count=5}\n``` {.python .cell-code}\n# Cr√©er un pairplot pour visualiser les relations\nsns.pairplot(\n    df, \n    hue='species_name',\n    diag_kind='kde',\n    markers=['o', 's', 'D'],\n    plot_kws={'alpha': 0.6}\n)\nplt.suptitle('Relations entre les Features', y=1.02, fontsize=16)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](python-example_files/figure-html/cell-6-output-1.png){}\n:::\n:::\n\n\n### Matrice de Corr√©lation\n\n::: {#c6be59e0 .cell execution_count=6}\n``` {.python .cell-code}\n# Calculer la matrice de corr√©lation\ncorrelation_matrix = df[iris.feature_names].corr()\n\n# Visualiser avec une heatmap\nplt.figure(figsize=(10, 8))\nsns.heatmap(\n    correlation_matrix, \n    annot=True, \n    fmt='.2f',\n    cmap='coolwarm',\n    square=True,\n    linewidths=1,\n    cbar_kws={\"shrink\": 0.8}\n)\nplt.title('Matrice de Corr√©lation des Features', fontsize=14, fontweight='bold')\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nüí° Observations :\")\nprint(\"- Petal length et petal width sont fortement corr√©l√©es (0.96)\")\nprint(\"- Ces features semblent tr√®s discriminantes pour la classification\")\n```\n\n::: {.cell-output .cell-output-display}\n![](python-example_files/figure-html/cell-7-output-1.png){}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nüí° Observations :\n- Petal length et petal width sont fortement corr√©l√©es (0.96)\n- Ces features semblent tr√®s discriminantes pour la classification\n```\n:::\n:::\n\n\n## üîß Pr√©paration des Donn√©es\n\n::: {#721887a1 .cell execution_count=7}\n``` {.python .cell-code}\n# S√©parer features et target\nX = df[iris.feature_names].values\ny = df['species'].values\n\n# Split train/test\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, \n    test_size=0.3, \n    random_state=42,\n    stratify=y\n)\n\n# Normalisation des features\nscaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)\n\nprint(f\"‚úÖ Donn√©es pr√©par√©es :\")\nprint(f\"   - Training set : {X_train.shape[0]} √©chantillons\")\nprint(f\"   - Test set : {X_test.shape[0]} √©chantillons\")\nprint(f\"   - Features : {X_train.shape[1]}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n‚úÖ Donn√©es pr√©par√©es :\n   - Training set : 105 √©chantillons\n   - Test set : 45 √©chantillons\n   - Features : 4\n```\n:::\n:::\n\n\n## ü§ñ Entra√Ænement des Mod√®les\n\n### Mod√®le 1 : R√©gression Logistique\n\n::: {#12108fec .cell execution_count=8}\n``` {.python .cell-code}\n# Cr√©er et entra√Æner le mod√®le\nlogreg = LogisticRegression(\n    random_state=42,\n    max_iter=200\n)\nlogreg.fit(X_train_scaled, y_train)\n\n# Pr√©dictions\ny_pred_logreg = logreg.predict(X_test_scaled)\naccuracy_logreg = accuracy_score(y_test, y_pred_logreg)\n\nprint(f\"üìä R√©gression Logistique\")\nprint(f\"   Accuracy : {accuracy_logreg:.2%}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nüìä R√©gression Logistique\n   Accuracy : 91.11%\n```\n:::\n:::\n\n\n### Mod√®le 2 : Random Forest\n\n::: {#357a4339 .cell execution_count=9}\n``` {.python .cell-code}\n# Cr√©er et entra√Æner le mod√®le\nrf = RandomForestClassifier(\n    n_estimators=100,\n    random_state=42,\n    max_depth=5\n)\nrf.fit(X_train, y_train)\n\n# Pr√©dictions\ny_pred_rf = rf.predict(X_test)\naccuracy_rf = accuracy_score(y_test, y_pred_rf)\n\nprint(f\"üå≥ Random Forest\")\nprint(f\"   Accuracy : {accuracy_rf:.2%}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nüå≥ Random Forest\n   Accuracy : 88.89%\n```\n:::\n:::\n\n\n## üìä √âvaluation des Performances\n\n### Matrice de Confusion\n\n::: {#c1b0809b .cell execution_count=10}\n``` {.python .cell-code}\n# Matrice de confusion pour Random Forest\ncm = confusion_matrix(y_test, y_pred_rf)\n\n# Visualisation\nplt.figure(figsize=(10, 8))\nsns.heatmap(\n    cm, \n    annot=True, \n    fmt='d',\n    cmap='Blues',\n    xticklabels=iris.target_names,\n    yticklabels=iris.target_names,\n    square=True,\n    linewidths=1\n)\nplt.title('Matrice de Confusion - Random Forest', fontsize=14, fontweight='bold')\nplt.ylabel('Vraie classe')\nplt.xlabel('Classe pr√©dite')\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](python-example_files/figure-html/cell-11-output-1.png){}\n:::\n:::\n\n\n### Rapport de Classification\n\n::: {#3864cd12 .cell execution_count=11}\n``` {.python .cell-code}\nprint(\"üìã Rapport de Classification D√©taill√© (Random Forest) :\\n\")\nprint(classification_report(\n    y_test, \n    y_pred_rf,\n    target_names=iris.target_names,\n    digits=3\n))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nüìã Rapport de Classification D√©taill√© (Random Forest) :\n\n              precision    recall  f1-score   support\n\n      setosa      1.000     1.000     1.000        15\n  versicolor      0.778     0.933     0.848        15\n   virginica      0.917     0.733     0.815        15\n\n    accuracy                          0.889        45\n   macro avg      0.898     0.889     0.888        45\nweighted avg      0.898     0.889     0.888        45\n\n```\n:::\n:::\n\n\n### Importance des Features (Random Forest)\n\n::: {#7dc7177d .cell execution_count=12}\n``` {.python .cell-code}\n# Extraire l'importance des features\nfeature_importance = pd.DataFrame({\n    'feature': iris.feature_names,\n    'importance': rf.feature_importances_\n}).sort_values('importance', ascending=False)\n\n# Visualisation\nplt.figure(figsize=(10, 6))\nplt.barh(\n    feature_importance['feature'], \n    feature_importance['importance'],\n    color='#4ECDC4'\n)\nplt.xlabel('Importance')\nplt.title('Importance des Features - Random Forest', fontsize=14, fontweight='bold')\nplt.gca().invert_yaxis()\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nüîç Features les plus importantes :\")\nprint(feature_importance.to_string(index=False))\n```\n\n::: {.cell-output .cell-output-display}\n![](python-example_files/figure-html/cell-13-output-1.png){}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nüîç Features les plus importantes :\n          feature  importance\n petal width (cm)    0.454769\npetal length (cm)    0.401161\nsepal length (cm)    0.121437\n sepal width (cm)    0.022633\n```\n:::\n:::\n\n\n## üìà Comparaison des Mod√®les\n\n::: {#71a0a2b4 .cell execution_count=13}\n``` {.python .cell-code}\n# R√©sum√© des performances\nresults = pd.DataFrame({\n    'Mod√®le': ['R√©gression Logistique', 'Random Forest'],\n    'Accuracy': [accuracy_logreg, accuracy_rf],\n    'Pr√©cision': [\n        accuracy_logreg,\n        accuracy_rf\n    ]\n})\n\nprint(\"\\nüèÜ Comparaison des Mod√®les :\")\nprint(results.to_string(index=False))\n\n# Visualisation\nplt.figure(figsize=(10, 6))\nx = np.arange(len(results))\nwidth = 0.35\n\nplt.bar(x, results['Accuracy'], width, label='Accuracy', color='#FF6B6B', alpha=0.8)\nplt.xlabel('Mod√®le')\nplt.ylabel('Score')\nplt.title('Comparaison des Performances', fontsize=14, fontweight='bold')\nplt.xticks(x, results['Mod√®le'])\nplt.ylim(0.85, 1.0)\nplt.legend()\nplt.grid(axis='y', alpha=0.3)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nüèÜ Comparaison des Mod√®les :\n               Mod√®le  Accuracy  Pr√©cision\nR√©gression Logistique  0.911111   0.911111\n        Random Forest  0.888889   0.888889\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](python-example_files/figure-html/cell-14-output-2.png){}\n:::\n:::\n\n\n## üéØ Conclusions\n\n::: {#c1919117 .cell execution_count=14}\n``` {.python .cell-code}\nprint(\"=\" * 60)\nprint(\"üìå CONCLUSIONS DE L'ANALYSE\")\nprint(\"=\" * 60)\nprint(f\"\\n‚úÖ Meilleur mod√®le : Random Forest\")\nprint(f\"   Accuracy : {accuracy_rf:.2%}\")\nprint(f\"\\nüí° Insights cl√©s :\")\nprint(f\"   - Les features 'petal' sont les plus discriminantes\")\nprint(f\"   - Excellente s√©parabilit√© des classes\")\nprint(f\"   - Mod√®le pr√™t pour la production\")\nprint(\"\\n\" + \"=\" * 60)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n============================================================\nüìå CONCLUSIONS DE L'ANALYSE\n============================================================\n\n‚úÖ Meilleur mod√®le : Random Forest\n   Accuracy : 88.89%\n\nüí° Insights cl√©s :\n   - Les features 'petal' sont les plus discriminantes\n   - Excellente s√©parabilit√© des classes\n   - Mod√®le pr√™t pour la production\n\n============================================================\n```\n:::\n:::\n\n\n---\n\n::: {.callout-note}\n## üìö Pour aller plus loin\n\n- Testez d'autres algorithmes (SVM, Gradient Boosting)\n- Optimisez les hyperparam√®tres avec GridSearchCV\n- Ajoutez de la validation crois√©e\n- Explorez le feature engineering avanc√©\n:::\n\n",
    "supporting": [
      "python-example_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}